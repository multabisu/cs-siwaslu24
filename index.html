<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CS Siwaslu24</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css"
      rel="stylesheet"
    />
    
  </head>
  <body>
    <div id="app" class="relative" style="min-height: 100vh">
      <div class="p-4">
        <div v-if="!isAlreadyLogin">

          
          <form @submit.prevent="loginAdmin" class="max-w-sm mx-auto">
            <img src="/lupapw.png" width="300" height="300" class="mx-auto mb-4" />
            <div class="mb-5">
              <label
                for="email"
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Your email</label
              >
              <input
                v-model="adminForm.email"
                type="email"
                id="email"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                required
              />
            </div>
            <div class="mb-5">
              <label
                for="password"
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Your password</label
              >
              <input
                v-model="adminForm.password"
                type="password"
                id="password"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                required
              />
            </div>
            <button
              type="submit"
              class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
            >
              Submit
            </button>
          </form>
        </div>

        <div v-show="isAlreadyLogin" class="lg:flex gap-8">

          <div 
          class="w-full"
          >
            <div class="text-center p-4">
              <h1 class="text-3xl font-bold">CUMUNGUD EAK KAQ {{ admin_name.toUpperCase() }} ðŸ˜˜</h1>
              <small>Emang begitu user mah. Pokoknya tetap tenang dan sabar. Salam awas!</small>
            </div>

            <h1
              class="text-bold text-2xl mb-2 border-b rounded-md p-2 bg-blue-200"
            >
              Cari User
            </h1>
  
            <form @submit.prevent="searchUser()">
              <div class="grid gap-6 mb-6 md:grid-cols-4">
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >ID</label
                  >
                  <input
                    type="text"
                    placeholder="ID"
                    v-model="user.id"
                    :class="{
                      'bg-red-200' : user.id,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Nama</label
                  >
                  <input
                    type="text"
                    placeholder="Nama"
                    v-model="user.name"
                    :class="{
                      'bg-red-200' : user.name,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Nomor Telepon</label
                  >
                  <input
                    type="text"
                    placeholder="Nomor"
                    v-model="user.phone"
                    :class="{
                      'bg-red-200' : user.phone,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Level</label
                  >
                  <select v-model="user.level" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                    <option selected value="">Pilih Level</option>
                    <option value="5">PTPS</option>
                    <option value="4">Desa/Kelurahan</option>
                    <option value="3">Kecamatan</option>
                    <option value="2">Kab/Kota</option>
                    <option value="1">Provinsi</option>
                    <option value="6">Pusat</option>
                    <option value="999">Tidak Aktif</option>
                  </select>
                </div>
              </div>
              <div class="grid gap-6 mb-6 md:grid-cols-4">
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Provinsi</label
                  >
                  <input
                    type="text"
                    placeholder="Provinsi"
                    v-model="user.provinsi"
                    :class="{
                      'bg-red-200' : user.provinsi,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Kabupaten/Kota</label
                  >
                  <input
                    type="text"
                    placeholder="Kabupaten / Kota"
                    v-model="user.kab_kota"
                    :class="{
                      'bg-red-200' : user.kab_kota,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Kecamatan</label
                  >
                  <input
                    type="text"
                    placeholder="Kecamatan"
                    v-model="user.kecamatan"
                    :class="{
                      'bg-red-200' : user.kecamatan,
                    }"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  />
                </div>
                <div>
                  <label
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                    >Desa/Kelurahan</label
                  >
                  <div class="flex gap-1">
                    <input
                      type="text"
                      placeholder="Desa / Kelurahan"
                      v-model="user.desa_kel"
                      :class="{
                        'bg-red-200' : user.desa_kel,
                      }"
                      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                    />
                    <input
                      type="number"
                      placeholder="TPS"
                      v-model="user.tps"
                      :class="{
                        'bg-red-200' : user.tps,
                      }"
                      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                    />

                  </div>
                </div>
              </div>
  
              <button
                type="submit"
                :disabled="isSearchDisabled"
                class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
              >
                Cari
              </button>
              <button
                @click.prevent="reset()"
                class="text-blue-700 bg-white ml-2 border border-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
              >
                Reset
              </button>
            </form>
  
            <div class="mt-10">
              <h1
                class="text-bold text-2xl mb-2 border-b rounded-md p-2 bg-blue-200"
              >
                Daftar User
              </h1>
  
              <div class="relative overflow-x-auto shadow-md sm:rounded-lg">
                <table
                  class="w-full text-xs text-left rtl:text-right text-gray-500 dark:text-gray-400"
                >
                  <thead
                    class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"
                  >
                    <tr>
                      <th scope="col" class="px-6 py-3">ID</th>
                      <th scope="col" class="px-6 py-3">Nama</th>
                      <th scope="col" class="px-6 py-3">HP</th>
                      <th scope="col" class="px-6 py-3">Level</th>
                      <th scope="col" class="px-6 py-3">Provinsi</th>
                      <th scope="col" class="px-6 py-3">Kab / Kota</th>
                      <th scope="col" class="px-6 py-3">Kecamatan</th>
                      <th scope="col" class="px-6 py-3">Desa / Kel</th>
                      <th scope="col" class="px-6 py-3">TPS</th>
                      <th scope="col" class="px-6 py-3">Aksi</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      v-for="item in listUser"
                      class="odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700"
                    >
                      <th
                        scope="row"
                        class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"
                      >
                        {{ item.id }}
                      </th>
                      <td class="px-4 py-2">{{ item.name }}</td>
                      <td class="px-4 py-2">{{ item.phone }}</td>
                      <td class="px-4 py-2">{{ item.type }}</td>
                      <td class="px-4 py-2">
                        {{ item.name_provinsi ? item.name_provinsi : "" }}
                      </td>
                      <td class="px-4 py-2">
                        {{ item.name_kab_kota ? item.name_kab_kota : "" }}
                      </td>
                      <td class="px-4 py-2">
                        {{ item.name_kecamatan ? item.name_kecamatan : "" }}
                      </td>
                      <td class="px-4 py-2">
                        {{ item.name_desa_kel ? item.name_desa_kel : "" }}
                      </td>
                      <td class="px-4 py-2">{{ item.tps ? item.tps : "-" }}</td>
                      <td class="px-4 py-2">
                        <button
                          class="bg-blue-500 hover:bg-blue-400 text-white px-4 py-2 rounded-lg"
                          @click="select(item)"
                          data-drawer-target="drawer-data-user" data-drawer-show="drawer-data-user" aria-controls="drawer-data-user"
                        >
                          Pilih
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>

                
              </div>
            </div>
  
            
          </div>

          <div id="drawer-data-user" class="fixed top-0 left-0 z-40 h-screen p-4 overflow-y-auto transition-transform -translate-x-full bg-white w-full lg:w-1/2 dark:bg-gray-800" tabindex="-1" aria-labelledby="drawer-label">
            <div class="flex justify-between items-center border-b-2 border-gray-500 mb-4">
              <h2 class="mb-4 font-bold text-xl">Data User</h2>

              <button id="btn-close-drawer-user" type="button" data-drawer-hide="drawer-data-user" aria-controls="drawer-data-user" class="text-gray-400 bg-transparent hover:bg-red-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 absolute top-2.5 end-2.5 flex items-center justify-center dark:hover:bg-gray-600 dark:hover:text-white" >
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                   <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close menu</span>
             </button>
            </div>
              
              <div>
                <div class="lg:grid grid-cols-3 gap-4">
                  <div v-for="(value, key) in selectedUser">
                    <div v-if="[1, 2, 3, 4, 5].includes(selectedUser.level_id)" class="border-b pb-2 border-gray-300">
                        <label class="block mb-2 text-sm font-medium text-gray-500 dark:text-white">{{ key }}</label>
                        <div v-if="key == 'id'"><p class="font-semibold">{{ value }}</p></div>

                        <div v-else-if="key == 'name'">
                          <input v-model="payloadChangeUser.name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"  required>
                        </div>
                        
                        <div v-else-if="key == 'phone'">
                          <input v-model="payloadChangeUser.phone" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                        </div>
                        
                        <div v-else-if="key == 'tps_no' && selectedUser.level_id === 5">
                          <input v-if="value" v-model="payloadChangeUser.tps" type="number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"  >
                          <p v-else>-</p>
                        </div>

                        <div v-else-if=" ['id_provinsi', 'id_kab_kota', 'id_kecamatan', 'id_desa_kel', 'name_provinsi', 'level_id', 'name_kab_kota', 'name_kecamatan', 'name_desa_kel'].includes(key)"><p class="font-semibold">{{ value }}</p></div>
                        <div v-else><p class="font-semibold p-2 text-xs rounded-lg" :class="{
                          'bg-green-500 text-white' : value, 'bg-red-500 text-white' : !value,
                        }">{{ value === 1 ? 'Sudah Kirim Formulir' : 'Belum' }}</p></div>
                    </div>
                    <div v-else class="border-b pb-2 border-gray-300">
                      <label class="block mb-2 text-sm font-medium text-gray-500 dark:text-white">{{ key }}</label>
                      <div v-if="key == 'id'"><p class="font-semibold">{{ value }}</p></div>

                      <div v-else-if="key == 'name'">
                        <input v-model="payloadChangeUser.name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"  required>
                      </div>
                      
                      <div v-else-if="key == 'phone'">
                        <input v-model="payloadChangeUser.phone" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                      </div>
                      
                      <div v-else-if="key == 'tps_no' && selectedUser.level_id === 5">
                        <input v-if="value" v-model="payloadChangeUser.tps" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"  >
                        <p v-else>-</p>
                      </div>
                      <div v-else><p class="font-semibold">{{ value ? value : '-' }}</p></div>
                  </div>
                  </div>
                  <div class="border-b pb-2 border-gray-300">
                      <label class="block mb-2 text-sm font-medium text-gray-500 dark:text-white">Password</label>
                      <div v-if="isChangePassword">
                        <input v-model="payloadChangeUser.password" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"  required>
                        <button @click="isChangePassword = false" class="text-xs underline">batal</button>
                      </div>
                      <button v-else class="px-4 py-2 bg-blue-500 rounded-lg text-xs text-white" @click="isChangePassword = true">Ganti Password?</button>
                  </div>
                </div>

                <div class="flex gap-2 mt-4">
                  <button data-modal-target="popup-update-user" data-modal-toggle="popup-update-user"  class="mt-4 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center ">Update User</button>
                  <button data-modal-target="popup-reset-user-form" data-modal-toggle="popup-reset-user-form" class="mt-4 ring-gray-700 border hover:bg-red-200 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center ">Reset Form User</button>
                  <button data-modal-target="popup-deactivate-user" data-modal-toggle="popup-deactivate-user" class="mt-4 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center ">Delete Account</button>
                  <button @click.prevent="directChangePassword" class="mt-4 text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-800 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center">Reset Password</button>
                </div>
              </div>
         </div>
        </div>
      </div>

      <div v-if="isLoading"
        class="absolute top-0 bg-blue-200 bg-opacity-30 z-50 h-full w-full flex items-center justify-center"
        >
        <div role="status" class="absolute -translate-x-1/2 -translate-y-1/2 top-2/4 left-1/2">
          <img src="/lupapw.png" width="300" height="300" class="mb-4" />
            <svg aria-hidden="true" class="w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/><path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/></svg>
            <span class="sr-only">Loading...</span>

        </div>
      </div>
        
        <div id="popup-update-user" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
            <div class="relative p-4 w-full max-w-md max-h-full">
                <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                    <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-red-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-update-user">
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                        <span class="sr-only">Close modal</span>
                    </button>
                    <div class="p-4 md:p-5 text-center">
                        <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                        </svg>
                        <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Yakin merubah data user?</h3>
                        <button @click="updateUser" data-modal-hide="popup-update-user" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                            Iyak, yakin beud.
                        </button>
                        <button data-modal-hide="popup-update-user" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">Gajadi ah</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="popup-reset-user-form" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
          <div class="relative p-4 w-full max-w-md max-h-full">
              <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                  <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-red-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-reset-user-form">
                      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                      </svg>
                      <span class="sr-only">Close modal</span>
                  </button>
                  <div class="p-4 md:p-5 text-center">
                      <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                      </svg>
                      <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Yakin mereset form data user?</h3>
                      <button @click="resetFormOrDeactivate(false)" data-modal-hide="popup-reset-user-form" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                          Iyak, yakin beud.
                      </button>
                      <button data-modal-hide="popup-reset-user-form" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">Gajadi ah</button>
                  </div>
              </div>
          </div>
      </div>
        
      <div id="popup-deactivate-user" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
          <div class="relative p-4 w-full max-w-md max-h-full">
              <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                  <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-red-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-deactivate-user">
                      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                      </svg>
                      <span class="sr-only">Close modal</span>
                  </button>
                  <div class="p-4 md:p-5 text-center">
                      <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                      </svg>
                      <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Yakin Nonaktifkan data user?</h3>
                      <button @click="resetFormOrDeactivate(true)" data-modal-hide="popup-deactivate-user" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                          Iyak, yakin beud.
                      </button>
                      <button data-modal-hide="popup-deactivate-user" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">Gajadi ah</button>
                  </div>
              </div>
          </div>
      </div>

        <button id="button-show-drawer" class="hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800" type="button" data-drawer-target="drawer-data-user" data-drawer-show="drawer-data-user" aria-controls="drawer-data-user">
          Show drawer
          </button>
        

    <script>
      const { createApp, ref, computed } = Vue;

      createApp({
        setup() {
          // const baseUrl = "http://127.0.0.1:8000";
          const baseUrl = "//103.249.227.191";
          // const baseUrl = "https://siwaslu2024.bawaslu.go.id/api"; 
          const isLoading = ref(false);
          const isAlreadyLogin = ref(false);
          const access_token = ref("");
          const adminForm = ref({
            email: "",
            password: "",
          });
          const page = ref(1);
          const admin_name = ref(''); 
          const user = ref({
            id: "",
            name: "",
            phone: "",
            provinsi: "",
            level: "",
            kab_kota: "",
            kecamatan: "",
            desa_kel: "",
            tps: "",
          });
          const listUser = ref([]);
          const selectedUser = ref({
            id: null,
              type: "",
              name: "",
              name_provinsi: "",
              name_kab_kota: "",
              name_kecamatan: "",
              name_desa_kel: "",
              phone: "",
              tps: 0,
              password: ""
          });
          const isChangePassword = ref(false);
          const payloadChangeUser = ref({
            id: null,
            name: "",
            phone: "",
            tps: 0,
            password: "",
          });

          // LOGIN ADMIN
          const loginAdmin = () => {
            const payload = {
              email: adminForm.value.email,
              password: adminForm.value.password,
            };

            async function postLoginAdmin() {
              isLoading.value = true;
              const responseLoginAdmin = await fetch(
                baseUrl + "/api/login-admin",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(payload),
                }
              );

              return responseLoginAdmin.json();
            }

            postLoginAdmin().then((x) => {
              if (x.code == 200) {
                isAlreadyLogin.value = true;
                access_token.value = x.data.access_token;
                admin_name.value = x.data.admin.name;
              }

              isLoading.value = false;
            });
          };

          const searchUser = () => {
             async function postsearchUser() {
              isLoading.value = true;
              const responsesearchUser = await fetch(
                baseUrl +
                  `/api/user?${
                    user.value.name ? "&name=" + user.value.name : ""
                  }${user.value.id ? "&id=" + user.value.id : ""}${
                    user.value.phone ? "&phone=" + user.value.phone : ""
                  }${
                    user.value.provinsi ? "&name_provinsi=" + user.value.provinsi : ""
                  }${
                    user.value.kab_kota ? "&name_kab_kota=" + user.value.kab_kota : ""
                  }${
                    user.value.kecamatan ? "&name_kecamatan=" + user.value.kecamatan : ""
                  }${
                    user.value.desa_kel ? "&name_desa_kel=" + user.value.desa_kel : ""
                  }${
                    user.value.level ? "&level=" + user.value.level : ""
                  }${
                    user.value.tps ? "&tps=" + user.value.tps : ""
                  }&page=1`,
                {
                  method: "GET",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: access_token.value,
                  },
                }
              );

              return responsesearchUser.json();
            }

            postsearchUser().then((x) => {
              listUser.value = x.data.data;

              isLoading.value = false;
            });
          };

          const select = (value) => {
            document.getElementById('button-show-drawer').click()

            payloadChangeUser.value = {
              id: null,
              name: "",
              phone: "",
              tps: 0,
              password: "",
            };

            async function postselectUser() {
              isLoading.value = true;
              const responseselectUser = await fetch(
                baseUrl + `/api/user/${value.id}?withform=1`,
                {
                  method: "GET",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: access_token.value,
                  },
                }
              );

              return responseselectUser.json();
            }

            postselectUser().then((x) => {
              isLoading.value = false;
              isChangePassword.value = false;

              payloadChangeUser.value = {
                id: x.data.id,
                name: x.data.name,
                phone: x.data.phone,
                tps: x.data.tps_no,
                password: "",
              };

              selectedUser.value = x.data;
            });
          };

          const reset = () => {
            user.value = {
              id: null,
              name: "",
              phone: "",
            };

            isChangePassword.value = false;

            payloadChangeUser.value = {
              id: null,
              name: "",
              phone: "",
              tps: 0,
              password: "",
            };
            listUser.value = [];

            selectedUser.value = {};
          };

          const updateUser = async () => {
            const payload = {};

            if (selectedUser.value.name !== payloadChangeUser.value.name) {
              payload.name = payloadChangeUser.value.name;
            }

            if (selectedUser.value.phone !== payloadChangeUser.value.phone) {
              payload.phone = payloadChangeUser.value.phone;
            }

            if (selectedUser.value.tps_no !== payloadChangeUser.value.tps) {
              payload.tps = payloadChangeUser.value.tps;
            }

            if (isChangePassword.value) {
              payload.password = payloadChangeUser.value.password;
            }

            isLoading.value = true;
            await fetch(baseUrl + "/api/cs/user/" + selectedUser.value.id, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: access_token.value,
              },
              body: JSON.stringify(payload),
            })
              .then((response) => {
                document.getElementById('btn-close-drawer-user').click()
                isLoading.value = false;
                if (response.ok) {
                  alert("Manteb Berhasil nih!!");
                  return response.json();
                } else {
                  alert(
                    "Error dari serpernya nih. Coba tanya umar ganteng gih."
                    );
                }
              })
              .then((json) => {
                // all good, token is ready
                searchUser();
              })
              .catch((error) => {
                isLoading.value = false;
                console.log("error", error.response);
              });
          };

          const directChangePassword = async () => {
            const payload = {};

            payload.password = 'siwaslu2024';

            isLoading.value = true;
            await fetch(baseUrl + "/api/cs/user/" + selectedUser.value.id, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: access_token.value,
              },
              body: JSON.stringify(payload),
            })
              .then((response) => {
                alert("Manteb Berhasil nih!! Dah keganti passwordnya jadi 'siwaslu2024'");
                document.getElementById('btn-close-drawer-user').click()
                isLoading.value = false;
                if (response.ok) {
                  return response.json();
                } else {
                  alert(
                    "Error dari serpernya nih. Coba tanya umar ganteng gih."
                  );
                }
              })
              .then((json) => {
                // all good, token is ready
                searchUser();
              })
              .catch((error) => {
                isLoading.value = false;
                console.log("error", error);
              });
          };
          
          const accessLogin = async (value) => {
            const payload = {};

            payload.active = value;

            isLoading.value = true;
            await fetch(baseUrl + "/api/cs/user/" + selectedUser.value.id, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: access_token.value,
              },
              body: JSON.stringify(payload),
            })
              .then((response) => {
                alert("Manteb Berhasil nih!! Dah keganti passwordnya jadi 'siwaslu2024'");
                document.getElementById('btn-close-drawer-user').click()
                isLoading.value = false;
                if (response.ok) {
                  return response.json();
                } else {
                  alert(
                    "Error dari serpernya nih. Coba tanya umar ganteng gih."
                  );
                }
              })
              .then((json) => {
                // all good, token is ready
                searchUser();
              })
              .catch((error) => {
                isLoading.value = false;
                console.log("error", error);
              });
          };

          const resetFormOrDeactivate = (isDeactivate) => {
            async function postFormOrDeactivate() {
              isLoading.value = true;
              const responseFormOrDeactivate = await fetch(
                baseUrl + `/api/cs/user/${selectedUser.value.id}/reset_form${isDeactivate ? '?deactivate=1' : '' }`,
                {
                  method: "GET",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: access_token.value,
                  },
                }
              );

              return responseFormOrDeactivate.json();
            }

            postFormOrDeactivate().then((x) => {
              isLoading.value = false;
                              // all good, token is ready
              alert("Manteb Berhasil nih!!" + x.data.message);
              document.getElementById('btn-close-drawer-user').click()

              searchUser();
            });
          };


          const isSearchDisabled = computed((x) => {
            return user.value.id == "" && user.value.name == "" && user.value.name_provinsi == "" && user.value.name_kab_kota == "" && user.value.name_kecamatan == "" && user.value.name_desa_kel == "" && user.value.phone == null && user.value.level == ""
          })

          return {
            baseUrl,
            adminForm,
            isAlreadyLogin,
            isLoading,
            access_token,
            page,
            user,
            listUser,
            selectedUser,
            isChangePassword,
            payloadChangeUser,
            loginAdmin,
            admin_name,
            searchUser,
            select,
            reset,
            updateUser,
            resetFormOrDeactivate,
            isSearchDisabled,
            directChangePassword,
          };
        },
      }).mount("#app");
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>
  </body>
</html>

